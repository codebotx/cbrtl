<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Fourier Series | Chillpost.in</title><meta name=keywords content="post,math"><meta name=description content="An interactive guide to Fourier series"><meta name=author content="srijan_"><link rel=canonical href=https://anubhavp.dev/blog/posts/pages/fourier/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.min.4b3654b1e7f52ee40f91deb1259c5bf97d2d0b5568e3d5a85ecb142c731894b7.css integrity="sha256-SzZUsef1LuQPkd6xJZxb+X0tC1Vo49WoXssULHMYlLc=" rel="preload stylesheet" as=style><link rel=icon href=https://anubhavp.dev/blog/favicon.ico><link rel=apple-touch-icon href=https://anubhavp.dev/blog/apple-touch-icon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-F5NTM76P29"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F5NTM76P29",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary"><meta name=twitter:title content="Fourier Series | Chillpost.in"><meta name=twitter:description content="An interactive guide to Fourier series"><meta property="og:title" content="Fourier Series | Chillpost.in"><meta property="og:description" content="An interactive guide to Fourier series"><meta property="og:type" content="article"><meta property="og:url" content="https://anubhavp.dev/blog/posts/pages/fourier/"><meta property="og:image" content="https://anubhavp.dev/blog/papermod-cover.png"><meta property="og:image" content="https://anubhavp.dev/favicon.ico"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-08T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-08T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://anubhavp.dev/blog/posts/"},{"@type":"ListItem","position":2,"name":"Fourier Series","item":"https://anubhavp.dev/blog/posts/pages/fourier/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fourier Series | Chillpost.in","name":"Fourier Series","description":"An interactive guide to Fourier series","keywords":["post","math"],"wordCount":"3027","inLanguage":"en","datePublished":"2022-10-08T00:00:00Z","dateModified":"2022-10-08T00:00:00Z","author":{"@type":"Person","name":"srijan_"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://anubhavp.dev/blog/posts/pages/fourier/"},"publisher":{"@type":"Organization","name":"Chillpost.in","logo":{"@type":"ImageObject","url":"https://anubhavp.dev/blog/favicon.ico"}}}</script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body class="type-posts kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="auto",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://anubhavp.dev/blog/ accesskey=h title="Chillpost.in (Alt + H)">Chillpost.in</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://anubhavp.dev/blog/archives/ title=Archive>Archive</a></li><li><a href=https://anubhavp.dev/blog/search/ title="Search (Alt + /)" data-no-instant accesskey=/>Search</a></li><li><a href=https://anubhavp.dev/blog/tags/ title=Tags>Tags</a></li></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://anubhavp.dev/blog/>Home</a>&nbsp;»&nbsp;<a href=https://anubhavp.dev/blog/posts/>Posts</a></div><h1 class=post-title>Fourier Series</h1><div class=post-description>An interactive guide to Fourier series</div><div class=post-meta><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>October 8, 2022</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select:text"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style="user-select:text"/><line x1="7" y1="7" x2="7" y2="7" style="user-select:text"/></svg>
<span class=post-tags><a href=https://anubhavp.dev/blog/tags/post/>post</a><a href=https://anubhavp.dev/blog/tags/math/>math</a></span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>15 min</span></span></div></header><div class="toc side left"><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#adding-functions aria-label="Adding functions">Adding functions</a></li><li><a href=#decomposing-periodic-functions aria-label="Decomposing periodic functions.">Decomposing periodic functions.</a></li><li><a href=#drawing-with-the-fourier-series aria-label="Drawing with the Fourier series">Drawing with the Fourier series</a></li><li><a href=#epicycles aria-label=Epicycles>Epicycles</a></li><li><a href=#proof aria-label=Proof>Proof</a></li><li><a href=#origins aria-label=Origins>Origins</a></li><li><a href=#applications aria-label=Applications>Applications</a></li><li><a href=#resources-and-further-reading aria-label="Resources and further reading">Resources and further reading</a></li></ul></div></details></div><div class=post-content><blockquote><p><strong>NOTE:</strong> This blog post is taken from <a href=https://injuly.in/blog/fourier-series>injuly&rsquo;s website</a></p></blockquote><p>Try drawing something on the first canvas, and watch two sets of mechanical alien arms retrace your sketch:</p><div class="center fourier-canvas-pair"><canvas id=draw-canvas width=350 height=350 style="border:1px solid #000"></canvas>
<canvas id=redraw-canvas width=350 height=350 style="border:1px solid #000"></canvas></div><p>Once you&rsquo;re done with this introduction to Fourier analysis, you&rsquo;ll be capable of making this (and a lot more) yourself.</p><p>The satisfying animation is made possible by the subject of this post - an infinite sum called <a href=https://en.wikipedia.org/wiki/Fourier_series>the Fourier series</a>.
The formula is short, and with some effort, you can memorize it.
However, I implore you to understand where the series comes from, and build deeper intuition for it.</p><p>To keep you from clicking off this page,
I&rsquo;ll defer the proof and origin of this equation to the second half,
and thread some interactive animations through the body of this write-up.</p><h2 id=adding-functions>Adding functions<a hidden class=anchor aria-hidden=true href=#adding-functions>¶</a></h2><p>Surely, you&rsquo;re familiar with the addition of numbers, vectors and matrices.
Adding functions is not so different.
The addition of two functions \(f\) and \(g\) at input \(x\) is simply \(f(x) + g(x)\).</p><p>Put more formally - \((f + g)(x) = f(x) + g(x)\).</p><p>Let&rsquo;s visualize this by taking an example.
Assume <code>f</code> is \(2sin(x)\) and <code>g</code> is \(cos(2x)\).</p><p>Their sum then, can be given by a function - \(h(x) = 2sin(x) + cos(2x)\).</p><p>The graph below plots \(f\) and \(g\) in shades of gray, and their sum, \(h\), in red.</p><div class=center><canvas id=fun-sum width=350px height=350px></canvas></div><p>Note how in some places, the values of \(f\) and \(g\) are both positive, and their sum is therefore a larger positive number,
while in other places, \(f\) and \(g\) have opposite signs and their values cancel out to a smaller number.</p><p>Through the lens of physics, you could look at the functions as two electromagnetic waves, or just visible light rays oscillating in the domain of time.
When two such waves overlap with each other in space, they&rsquo;re said to be in <a href=https://www.britannica.com/science/principle-of-superposition-wave-motion>superposition</a>.
The superposition of two waves results in the sum of both waves.</p><p>When two points in a wave supplement each other to result in a higher amplitude (the y-value),
their interaction is termed &ldquo;constructive interference&rdquo;.
When they cancel each other out, it&rsquo;s called &ldquo;destructive interference&rdquo;.</p><p>Go through the last two paragraphs again, and try to digest this idea.
Now, imagine if we had to work our way backwards.
Say we are given a list containing the (x, y) coordinates of all points along the curve of \(h\),
where \(x\) is time and \(y\) is the corresponding output of \(h\) at that point in time.
We have to come up with two simpler periodic functions that sum up to \(h\).</p><p>This is exactly what the Fourier series does.</p><p>There are several ways to interpret interference in the real world.
If \(f\) and \(g\) were sound waves, their constructive interference would make loud noise, while the destructive interference would produce a quieter sound.
If they were light waves instead, their constructive interference would reveal bright spots on a reflective surface,
and destructive would look like dim patches.</p><p>Applications of the Fourier series spill into almost every domain -
signal processing, image compression, shape recognition,
analog transmission, noise cancellation, studying thermodynamic systems
and fitting equations to datasets.</p><p>From this wide array of applications, We show our interest in the science of tracing ugly sketches.</p><h2 id=decomposing-periodic-functions>Decomposing periodic functions.<a hidden class=anchor aria-hidden=true href=#decomposing-periodic-functions>¶</a></h2><p>Imagine you had a machine that could scan any food item and display its recipe.
Fourier series does exactly that, except for mathematical functions.</p><p>The Fourier series of any periodic function \(f(x)\) with a frequency of \(\omega_0\) is described as:</p><div class=tex>$$
f(x) = a_0/2 + \sum_{n=1}^{\infty}b_n sin(n\omega_0x) + \sum_{n=1}^{\infty}a_n cos(n\omega_0x)
$$</div><p>Meaning that for every periodic function \(f\),
there exists a set of coefficients \(a\) and \(b\),
such that \(f(x)\) can be expressed as an infinite sum of sine and cosine terms of increasing frequencies where the
\(nth\) sine term has a coefficient of \(b_n\) and the \(nth\) cosine term has a coefficient of \(a_n\).
The values of these coefficients are given by the following formulae:</p><p>$$
a_n = \int_0^T{f(x)cos(nw_0x)}
$$</p><p>$$
b_n = \int_0^T{f(x)sin(nw_0x)}
$$</p><p>The interval of integration, \(T\), is the fundamental period of the function.
\(T\) and \(\omega_0\) are related by this equation:</p><p>$$
\omega_0 = 2\pi/T
$$</p><p>If that was too wordy and made little sense to you, that&rsquo;s okay.
We&rsquo;ll prove this equation later in the post.
Until then, an example will help understand this better.</p><p>Consider the square wave - a periodic signal that alternates between 1 and -1 depending on its input.
Formally, it is described like so:</p><p>$$
f(t) = 4 \lfloor{t}\rfloor - 2\lfloor2t\rfloor + 1
$$</p><p>Here&rsquo;s how it looks when graphed out:</p><div class=center><canvas id=square-wave-graph width=350 height=350></canvas></div><p>If we use the first few terms from \(f\)&rsquo;s Fourier series, we can closely approximate the behavior of this function.
In the following graph, the gray curve represents the the square wave and the red curve represents our approximation of it.
You can play with the slider to alter the number of terms we take from the series and see how that changes our approximation.</p><div class=center><canvas id=square-wave-fourier-graph width=350 height=350></canvas><div classname=controls style="display:'flex';gap:2rem"><input type=range min=1 max=50 value=4 id=square-fs-slider style=width:300px></input></div></div><p>Clearly, our approximation improves as we take more terms from the series.
The Fourier series can be proven to <a href=https://en.wikipedia.org/wiki/Convergent_series>converge</a>.
This means that if we take an infinite number of terms from the series, we can get the <em>exact</em> value of \(f(x)\) for any \(x\).</p><p>Of course, it is not possible to add up infinite terms in computers.
Instead, we decide upon a fixed number of terms that approximate our function well enough for most practical purposes.</p><p>Whenever I say &ldquo;Fourier series of a function&rdquo;, I mean a series of simple periodic functions that can be added at any given input to approximate the output of the original function at the same input.
For the remainder of this post our goal with Fourier series is to <strong>approximate periodic functions with sums of simpler sine/cosine functions</strong>.</p><h2 id=drawing-with-the-fourier-series>Drawing with the Fourier series<a hidden class=anchor aria-hidden=true href=#drawing-with-the-fourier-series>¶</a></h2><p>If you wish to understand how the Fourier series works before seeing it in action,
you can skip this section and read ahead to <a href=#proof>the proof</a>, then come back here.</p><p>So, How do we go from decomposing time domain functions to recreating sketches?</p><p>Imagine you&rsquo;re drawing a sketch on a square sheet of paper.
You are to draw your sketch, start to finish, without lifting the nib of your pen from the paper&rsquo;s surface.
In other words, your sketch must be <em>continuous</em> with no &ldquo;breaks&rdquo; in between.</p><p>Assume also that the bottom-left corner of the sheet is its origin.
Once you start drawing, I can delineate the position of the pen&rsquo;s tip using a pair of coordinates \((x, y)\) at any given point in time.</p><p>Much like a cartesian plane, the \(x\) coordinate represents the horizontal distance from the origin, and \(y\) the vertical.
Both the x and y coordinates change as the pen moves on the sheet&rsquo;s surface.
Meaning, the position of the x-coordinate of your pen&rsquo;s tip can be written as a function of time.
Say you draw this figure:</p><div class=center><canvas id=rabbit-canvas width=350 height=350></canvas></div><p>If we plot the x and y-coordinates independently as functions of time, they&rsquo;ll form curves that look like this:</p><div class=center><canvas id=rabbit-plot-canvas width=350 height=350></canvas></div><p>The blue curve represents the values of x-coordinates of your sketch.
The vertical axis represents the x-value, and the horizontal axis represents time.
Similarly, the red curve plots the y-coordinates.</p><p>Both these curves can be viewed as functions of time.
The blue curve represents a function \(x(t)\) that returns the x-position of the pen&rsquo;s tip at time \(t\),
Similarly, the red curve is a function \(y(t)\) which the same for its y-position.
For each of these functions, we can find a Fourier series that approximates it.</p><p>Let \(f_x(t)\) and \(f_y(t)\) be the Fourier approximations for \(x(t)\) and \(y(t)\) respectively.
Then recreating the sketch requires computing the values returned by <code>f_t</code> and <code>y_t</code> over a range of values of t.
then pairing them into <code>(x, y)</code> coordinates and connecting the coordinates with lines.
Here is some pseudo-typescript code that mimics this logic:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=font-style:italic>// The &#34;dt&#34; is our time step.
</span></span></span><span style=display:flex><span><span style=font-style:italic>// In the real world, a line is an infinitely long series of points.
</span></span></span><span style=display:flex><span><span style=font-style:italic>// In computers, we take a &#34;snapshot&#34; of the pen&#39;s position
</span></span></span><span style=display:flex><span><span style=font-style:italic>// every dt seconds and join these positions with straight lines to
</span></span></span><span style=display:flex><span><span style=font-style:italic>// trace the curve. Smaller values of dt require more computation,
</span></span></span><span style=display:flex><span><span style=font-style:italic>// and yield better results.
</span></span></span><span style=display:flex><span><span style=font-style:italic></span><span style=font-weight:700>const</span> dt = 0.01;
</span></span><span style=display:flex><span><span style=font-weight:700>const</span> f_x = fourier_series(x); <span style=font-style:italic>// type of x is (t: number) =&gt; number
</span></span></span><span style=display:flex><span><span style=font-style:italic></span><span style=font-weight:700>const</span> f_y = fourier_series(y); <span style=font-style:italic>// type of y is (t: number) =&gt; number
</span></span></span><span style=display:flex><span><span style=font-style:italic></span><span style=font-weight:700>let</span> prev_point = [f_x(0), f_y(0)];
</span></span><span style=display:flex><span><span style=font-weight:700>for</span> (<span style=font-weight:700>let</span> t = 0.01; t &lt; 1; t += dt) {
</span></span><span style=display:flex><span>  <span style=font-weight:700>const</span> current_point = [f_x(t), f_y(t)];
</span></span><span style=display:flex><span>  draw_line(prev_point, current_point);
</span></span><span style=display:flex><span>  prev_point = current_point;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The approximation generated by this method is shown below.
Just as before, you can play with the slider to adjust the number of terms used in approximation of the sketch.</p><div class=center><canvas id=rabbit-recreate-canvas width=300 height=300></canvas><div classname=controls style="display:'flex';gap:2rem"><input type=range min=1 max=50 value=12 id=rabbit-slider style=width:300px></input></div></div><p>Keep in mind that <code>f_x</code> and <code>f_y</code> are really just sums of simpler sine/cosine functions, calculated using Fourier&rsquo;s formulae.</p><p>You may be wondering - the functions \(x(t)\) and \(y(t)\) aren&rsquo;t periodic, how come we can still decompose them into sine/cosine sums?
One trick is to set the period to infinity, and compute the series at this limit.</p><p>In my code, I just set the period to 1 time unit, and assume that the pen just retraces the drawing again and again.
Meaning that \(x(t + 1) = x(0)\).
This makes the math a lot easier, and certainly doesn&rsquo;t make a difference in the outcome.</p><p>To be more clear, when the sketch starts, the time is assumed to be 0, and when it ends, the time is assumed to be 1 second.
Every time point in between is scaled accordingly. This is not necessary of course, you could set the time period to however long it took to draw the first sketch, if that makes things simpler for you.</p><h2 id=epicycles>Epicycles<a hidden class=anchor aria-hidden=true href=#epicycles>¶</a></h2><p>The final caveat are the epicycles.
It is easy to just plot the values returned by \(f_x\) and \(f_y\) on the cartesian plane.
But how do we animate this using revolving circles?</p><p>If you&rsquo;ve followed the contents of this article so far, you already know how to recreate sketches.
To animate them, you need to understand <a href=https://en.wikipedia.org/wiki/Polar_coordinate_system>The polar coordinate system</a>.</p><p>You can read the wikipedia article, or <a href=https://www.mathsisfun.com/polar-cartesian-coordinates.html>this article</a> to build some intuition for conversion between cartesian and polar coordinates.</p><p>In the polar coordinate system, a periodic function with period \(T\) is a vector that rotates around the origin, and completes one full rotation around itself every \(T\) time units.
Look at the graph of \(sin(t)\) in Polar form, for example:</p><div class=center><canvas id=polar-sine width=350 height=350></canvas></div><p>Note how the y-coordinates of the vector&rsquo;s tip traces out a regular sine wave.
You can just as easily plot any periodic function in the polar coordinate system.
To add two periodic functions together, take one rotating vector and center it on the tip of the another rotating vector.
The end result is shown below.
The following animation shows 3 rotating vectors added together, each representing a periodic function:</p><div class=center><canvas id=two-rotating-vectors width=350 height=350></canvas></div><p>To convert a sketch to an epicycle animation then, all we need is to convert a term in the Fourier series from cartesian to polar coordinates.
Once we have that, we can add up the terms like in the animation above, and figure out the x and y-coordinates using two sets of epicycles, each representing the Fourier approximation for \(x(t)\) or \(y(t)\).</p><p>To do this conversion, we can use the <a href=https://en.wikipedia.org/wiki/Fourier_series#Amplitude-phase_form>polar form of the Fourier series</a>.
Precisely, these are the steps you need to follow:</p><ol><li>Represent the sketch as a list of points drawn over a period of time.</li><li>Convert the list of points into a two separate lists, one containing the x-coordinates of the sketch, and other the y.</li><li>Convert each list into a function (I use <a href=https://github.com/srijan-paul/fourier-sketch/blob/eb2be0f646f3097c6725ab621461ba59bfba4b6b/src/math/util.ts#L58>this simple helper</a>).
Now, you have the \(x(t)\) and \(y(t)\).</li><li>For each function, find its Fourier series coefficients. <a href=https://github.com/srijan-paul/fourier-sketch/blob/eb2be0f646f3097c6725ab621461ba59bfba4b6b/src/math/fourier.ts#L16>Here</a> is how I do it.</li><li>For each function, <a href=https://github.com/srijan-paul/fourier-sketch/blob/eb2be0f646f3097c6725ab621461ba59bfba4b6b/src/math/util.ts#L93>convert the Fourier series coefficients into a set of polar functions</a>.</li><li>Using a time step of <code>dt</code>, find the final x and y positions of our approximation, and <a href=https://github.com/srijan-paul/fourier-sketch/blob/eb2be0f646f3097c6725ab621461ba59bfba4b6b/src/components/RedrawCanvas.tsx#L21>draw them on a canvas</a>.</li></ol><p>If you do everything correctly, you should get something like this:</p><div class=center><canvas id=rabbit-epicycle width=350 height=350></canvas></div><p>There is a more novel approach to retracing sketches that involves using only one set of epicycles.
It uses <a href=https://en.wikipedia.org/wiki/Fourier_series#Complex-valued_functions>the complex Fourier Series</a>, and is also fewer lines of code.
When you&rsquo;re new to this concept however, it may throw you off balance, especially if you&rsquo;re not familiar with imaginary numbers and the Argand plane.</p><h2 id=proof>Proof<a hidden class=anchor aria-hidden=true href=#proof>¶</a></h2><p>When I set out to find an &ldquo;intuitive&rdquo; proof for the Fourier series,
all I saw were proofs that begin by stating the equation,
and then proving it by finding the coefficients \(a_n\) and \(b_n\) using integrals.
But where did the equation come from?</p><p>Did God whisper it to Joseph Fourier in his dreams?</p><p>Did he just happen to run into it by chance?</p><p>Surprisingly, the answer is &ldquo;yes&rdquo;.
Of course, he had an unparalleled instinct for math that he whetted with years of practice and research.
There has to be a certain train of thought that he boarded to arrive at this revelation, that any periodic signal can be represented as a sum of simpler harmonics.
But that line of thinking was never publicized, and as you&rsquo;ll see in the next section, there have been people who&rsquo;ve thought of this even before Fourier himself did!</p><p>The important part is that Fourier asked a question that was mocked as stupid and bizarre until he presented a proof.
And that proof does in fact begin by stating the following hypothesis:</p><p>$$
f_o(t) = \sum_{n = 0}^\infty{b_nsin(n\omega_0t)}
$$</p><p>Here, \(f_o\) is an odd function with a fundamental period of \(w_0\).
If we can derive a value for \(b_n\) from this equation, we can be convinced that <strong>any odd function can be represented as a sum of sinusoids</strong>.</p><p>Now, consider an even function \(f_e\) with a period of \(w_0\):</p><p>$$
f_e(t) = \sum_{n=0}^{\infty}a_n cos(n w_0 t)
$$</p><p>If we can derive a value for \(a_n\) from this equation, we can be convinced that <strong>any even function can be represented as a sum of co-sinusoids</strong>.</p><p>When you combine these two equations with the idea that <a href=https://en.wikipedia.org/wiki/Even_and_odd_functions#Even%E2%80%93odd_decomposition>any periodic function can be represented as a sum of odd and an even function</a>, you get:</p><p>$$
f_o(t) + f_e(t) = \sum_{n = 0}^\infty{b_nsin(n\omega_0t)} + \sum_{n=0}^{\infty}a_n cos(n w_0 t)
$$</p><p>We can turn the order of this proof, and first say that given any function \(f(t)\), we can find its odd and even parts using the odd-even decomposition rule.
Then, we can represent the odd part as a sum of sinusoids, and the even part as a sum of co-sinusoids.</p><p>Now, all that&rsquo;s left is to derive the values for \(a_n\) and \(b_n\) using the two equations stated above.
This is where I save myself the trouble of writing more LaTeX, and defer you to <a href=http://lpsa.swarthmore.edu/Fourier/Series/DerFS.html>this excellent proof</a> by professors from Swarthmore college.
I know I said I&rsquo;d walk you through the proof, but I can&rsquo;t do a better job of it than the electronics professors at Swarthmore did already.
I&rsquo;d hate to repeat their work and not give credit.
If you follow the page I linked, you&rsquo;ll realize that the proof only uses basic calculus and trigonometric identities taught in high school.</p><h2 id=origins>Origins<a hidden class=anchor aria-hidden=true href=#origins>¶</a></h2><p>You&rsquo;ll be surprised to learn that the idea behind the series predates Fourier himself.</p><p>2 centuries before Fourier, <a href=https://en.wikipedia.org/wiki/Carl_Friedrich_Gauss>Carl Friedrich Gauss</a> created several algorithms to aid his study of astronomy.
He was one of the many applied mathematicians who wanted to predict the position of Ceres in the night sky.
One of the algorithms he discovered in this quest, was the <a href=https://en.wikipedia.org/wiki/Fast_Fourier_transform>Fast Fourier Transform</a> - a function that is very closely related with the Fourier Series.
However, he never published his work because he believed his method to be an unimportant detail in his achievement of estimating Ceres&rsquo; position.</p><p>In the 1700s, Euler had found applications for decomposing periodic functions with Fourier Series.</p><p>Half a century before Fourier, <a href=https://en.wikipedia.org/wiki/Daniel_Bernoulli>Bernoulli</a> was studying the motion of a string.
He proposed the idea that periodic functions can be represented as sums of harmonics.
Nobody at the time believed this to be a general method, and his ideas were left unexplored.</p><p>Things changed in 1807, when a French math wizard named Joseph Fourier found himself studying the heat equation in a metal plate.
In his search for a solution, he sought to ask a seemingly absurd question:</p><p><em>Can we represent any periodic function as a sum of simple sine and cosine functions?</em></p><p>Precisely, he sought to represent any periodic function \(f(x)\) with a frequency of \(\omega_0\) , in the following form:</p><div class=tex>$$
f(x) = (a_0 + a_1 cos(\omega_0 t) + a_2 cos(2\omega_0 t) + ... + a_n cos(n\omega_0t)) + (b_1 sin(\omega_0 t) + b_1 sin(2\omega_0 t) + ... + b_n sin(n\omega_0t)
$$</div><p>Revered mathematicians of the time, including Langrange and Laplace, rejected this idea as informal and hand-wavy.
The panel evaluating his findings said:</p><p><em>&ldquo;The manner in which the author arrives at these equations is not exempt of difficulties and&mldr;his analysis to integrate them still leaves something to be desired on the score of generality and even rigour.&rdquo;</em>
Perhaps this was because of a lack of reasoning as to <em>why</em> one should even begin to think of periodic functions this way.</p><p>It&rsquo;s not unheard of mathematical ideas to sprout into existence out of seemingly ridiculous places.
Ramanujan attributed some of his major findings to God, and dipped at the age of 32.</p><p>After the Fourier Series was accepted by the scientific populace, it spawned a new field of research, called Fourier analysis.
Developments in this field found everyday use in almost every science.</p><h2 id=applications>Applications<a hidden class=anchor aria-hidden=true href=#applications>¶</a></h2><p>By this point, you know enough about Fourier analysis to delve deeper into it yourself.
It would be a shame to blunt the edge of theory by not applying it in practice.</p><p>Here a few things you could do:</p><ul><li>Implement noise reduction in sounds.</li><li>Sharpen images with denoising.</li><li>Write a <a href=https://en.wikipedia.org/wiki/JPEG>JPEG</a> encoder/decoder.</li><li><a href=https://www.johndcook.com/blog/2011/06/21/how-to-fit-an-elephant/>Fit an elephant</a></li><li>Write basic shape recognizers.</li></ul><h2 id=resources-and-further-reading>Resources and further reading<a hidden class=anchor aria-hidden=true href=#resources-and-further-reading>¶</a></h2><ul><li>3b1b - <a href="https://www.youtube.com/watch?v=r6sGWTCMz2k">But what is a Fourier series?</a>.</li><li>Swarthmore college - <a href=http://lpsa.swarthmore.edu/Fourier/Series/WhyFS.html>The fourier series</a>.</li><li>Jez Swanson - <a href=https://www.jezzamon.com/fourier/index.html>An interactive introduction to the fourier transform</a>.</li><li>Tony Rosler - <a href=https://www.myfourierepicycles.com/>myFourierEpicycles</a></li></ul><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lodash@4.17.20/lodash.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/gh/williamngan/pts/dist/pts.js></script>
<script type=module src=/js/fourier-series/index.js></script></div><footer class=post-footer><nav class=paginav><a class=prev href=https://anubhavp.dev/blog/posts/pages/rust/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></svg>&nbsp;Prev Page</span><br><span>Rust: The next C++ ?</span></a>
<a class=next href=https://anubhavp.dev/blog/posts/pages/metamuiwallet/><span class=title>Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span><br><span>Decentralization in MetaMUI Wallet: A Case Study</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://anubhavp.dev/blog/>Chillpost.in</a></span><span style=display:inline-block;margin-left:1em>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/blog/js/medium-zoom.min.js data-no-instant></script>
<script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a="1"=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script></body></html>